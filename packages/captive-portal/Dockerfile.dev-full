FROM node:22-slim

RUN apt-get update \
    && apt-get install -y xxd \
    && rm -rf /var/lib/apt/lists/* \
    && corepack enable \
    && corepack prepare pnpm@latest --activate

WORKDIR /deps

# Only package.json required - no lockfile needed
COPY package.json ./

# Install dependencies (creates fresh lockfile)
RUN pnpm install

WORKDIR /app/packages/captive-portal

CMD ["bash"]
